<!-- 
Contains the login-element
 -->

<link rel="import" href="../js/bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../js/bower_components/core-icons/core-icons.html">
<link rel="import" href="../js/bower_components/paper-elements/paper-elements.html">

<polymer-element name="login-element" attributes="loginUrl, csrfHeader">
<template>
<core-ajax id="loginEndpoint" 
           url="{{loginUrl}}"
           headers="{{csrfHeader}}"
	       handleAs="json" 
	       method="POST" 
	       on-core-response="{{loginResponse}}"
	       on-core-error="{{loginError}}"></core-ajax>
<paper-toast id="errorToast" text="Service Error!"></paper-toast>
<div>
  <table>
  <tr>
  <td>User Name:</td><td><paper-input value="{{credentials.username}}"></paper-input></td>
  </tr>
  <tr>
  <td>Password:</td><td><paper-input value="{{credentials.password}}"></paper-input></td>
  </tr>
  <tr><td>&nbsp;</td><td><paper-button raised on-click='{{login}}'>Login</paper-button></td></tr>
  </table>
</div>
</template>
<script>
    Polymer({
      //Use created function to initialize complex properties
      created: function() {
          this.loginUrl = "/login";
          this.credentials = {
          	username: "user",
          	password: "password"
          };
      },
      login: function() {
      	  this.$.loginEndpoint.params = JSON.stringify(this.credentials);
     	  this.$.loginEndpoint.go();
      },
      loginResponse: function() {
    	  this.fire('login');
      },
      loginError: function() {
    	  this.$.errorToast.text="Login Service Error";
    	  this.$.errorToast.show();
      }
  });
</script>
</polymer-element>
